name: daily-algorithm-alert

on:
  schedule:
    - cron: '0 11 * * 1,2,3,4,5' # UTC(ì˜¤ì „ 11ì‹œ) KST(UTC+9ì‹œê°„) -> ì˜¤í›„ 8, ì›”-ê¸ˆ ë™ì‘
    # - cron: '0 11 * * 1'   # Run weekly on Mondays at 8 PM
    # - cron: '0 11 1 * *'  # Run monthly on the 1st at 8 PM

jobs:
  alert-build:
    runs-on: ubuntu-latest

    steps:

      - name: Set Timezone to Asia/Seoul
        run: sudo timedatectl set-timezone Asia/Seoul

      - name: Print Current time in workflow
        run: date

      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # ì „ì²´ Git íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

      - name: POST algorithm repository daily alert to SLACK
        run: |
          chmod +x ./shell-scripts/statistics-algorithm-java-files.sh
          bash shell-scripts/statistics-algorithm-java-files.sh

      - name: Slack Message Send & Statistics
        run: |
          case ${{ env.DAILY_COUNT }} in
            0)
            MSG="ì˜¤ëŠ˜ì€ ë¬¸ì œë¥¼ í’€ì§€ ì•Šìœ¼ì…¨ì–´ìš”! ğŸ˜… ë‚´ì¼ì€ ì¡°ê¸ˆë§Œ ë” í˜ë‚´ë´ìš”!"
            ;;
            2 | 3)
            MSG="${{ env.DAILY_COUNT }}ë¬¸ì œ í•´ê²°! ğŸ’ª ê¾¸ì¤€í•¨ì´ ë¹›ì„ ë°œí•˜ê³  ìˆì–´ìš”. ê³„ì† íŒŒì´íŒ…! âœ¨"
            ;;
            4)
            MSG="${{ env.DAILY_COUNT }}ë¬¸ì œ í•´ê²°! ğŸ”¥ ëª©í‘œì— ê±°ì˜ ë„ë‹¬í–ˆì–´ìš”! ì •ë§ ë©‹ì ¸ìš” ğŸ‘"
            ;;
            *)
            MSG="${{ env.DAILY_COUNT }}ë¬¸ì œ í•´ê²°! ğŸ‰ ëŒ€ë‹¨í•´ìš”, ì§„ì‹¬ìœ¼ë¡œ ì¡´ê²½í•©ë‹ˆë‹¤!"
            ;;
            esac
            
            DAILY_MSG="*ğŸ“… ì˜¤ëŠ˜ì˜ ì•Œê³ ë¦¬ì¦˜ í™œë™ ë¦¬í¬íŠ¸*\n"
            DAILY_MSG+="\n"
            DAILY_MSG+="ğŸ—“ï¸ *ë‚ ì§œ*: _${{ env.TODAY }}_\n"
            DAILY_MSG+="ğŸ’¡ *ì„±ê³¼*: ${MSG}\n"
            DAILY_MSG+="\n"
            DAILY_MSG+="ğŸ“Š *ì´ë²ˆ ì£¼ ëˆ„ì *: ${{ env.WEEKLY_COUNT }}ë¬¸ì œ\n"
            DAILY_MSG+="ğŸ“ˆ *ì´ë²ˆ ë‹¬ ëˆ„ì *: ${{ env.MONTHLY_COUNT }}ë¬¸ì œ\n"
            DAILY_MSG+="\n"
            DAILY_MSG+="ğŸ”— *ìƒì„¸ ë‚´ì—­ ë³´ê¸°*: <https://github.com/yeeooni/baekjoon-slove|ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ ë°”ë¡œê°€ê¸°>"
          
          # SLACK channel to SEND
          curl -X POST --data-urlencode "payload={\"text\": \"${DAILY_MSG}\"}" ${{ secrets.SLACK_WEBHOOKS_URL }}
          
            
          
          
          
