name: update-submodules

# 특정 시간에 실행하도록 스케줄 설정
on:
  schedule:
    - cron: '0 0 * * *'  # 매일 자정에 실행 (cron 표현식 사용)

jobs:
  update-submodules:
    runs-on: ubuntu-latest

    steps:
      # 1. 리포지토리를 체크아웃
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          submodules: recursive  # 모든 서브모듈과 하위 서브모듈까지 체크아웃

      # 2. 최신 서브모듈 업데이트
      - name: Update Submodules
        run: |
          git submodule update --init --recursive
          git submodule foreach --recursive 'git pull origin $(git rev-parse --abbrev-ref HEAD)'

      # 3. 변경 사항 커밋 및 푸시
      - name: Commit and Push Changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add .
          git commit -m "Update submodules" || echo "No changes to commit"
          git push origin main